<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="author" content="order by dede58.com"/>
    <title>小米商城-个人中心</title>
    <link rel="stylesheet" type="text/css" href="__CSS__/style.css">

</head>
<body>
<!-- start header -->
<header>
    <div class="top center">
        <div class="left fl">
            <ul>
                <li><a href="http://www.mi.com/" target="_blank">小米商城</a></li>
                <li>|</li>
                <li><a href="">MIUI</a></li>
                <li>|</li>
                <li><a href="">米聊</a></li>
                <li>|</li>
                <li><a href="">游戏</a></li>
                <li>|</li>
                <li><a href="">多看阅读</a></li>
                <li>|</li>
                <li><a href="">云服务</a></li>
                <li>|</li>
                <li><a href="">金融</a></li>
                <li>|</li>
                <li><a href="">小米商城移动版</a></li>
                <li>|</li>
                <li><a href="">问题反馈</a></li>
                <li>|</li>
                <li><a href="">Select Region</a></li>
                <div class="clear"></div>
            </ul>
        </div>
        <div class="right fr">
            <div class="gouwuche fr"><a href="./dingdanzhongxin.html">我的订单</a></div>
            <div class="fr">
                <ul>
                    <li><a href="/shangcheng/login/loginOut" target="_blank">{$res}</a></li>
                    <li>|</li>
                    <li><a href="./register.html" target="_blank" >注册</a></li>
                    <li>|</li>
                    <li><a href="#top">个人中心</a></li>
                </ul>
            </div>
            <div class="clear"></div>
        </div>
        <div class="clear"></div>
    </div>
</header>
<!--end header -->
<!-- start banner_x -->
<div class="banner_x center">
    <a href="./index.html" target="_blank"><div class="logo fl"></div></a>
    <a href=""><div class="ad_top fl"></div></a>
    <div class="nav fl">
        <ul>
            <li><a href="">小米手机</a></li>
            <li><a href="">红米</a></li>
            <li><a href="">平板·笔记本</a></li>
            <li><a href="">电视</a></li>
            <li><a href="">盒子·影音</a></li>
            <li><a href="">路由器</a></li>
            <li><a href="">智能硬件</a></li>
            <li><a href="">服务</a></li>
            <li><a href="">社区</a></li>
        </ul>
    </div>
    <div class="search fr">
        <form action="" method="post">
            <div class="text fl">
                <input type="text" class="shuru"  placeholder="小米6&nbsp;小米MIX现货">
            </div>
            <div class="submit fl">
                <input type="submit" class="sousuo" value="搜索"/>
            </div>
            <div class="clear"></div>
        </form>
        <div class="clear"></div>
    </div>
</div>
<!-- end banner_x -->
<!-- self_info -->
<div class="grzxbj">
    <div class="selfinfo center">
        <div class="lfnav fl">
            <div class="ddzx">订单中心</div>
            <div class="subddzx">
                <ul>
                    <li><a href="/shangcheng/hotai/gerenzhongxin" >我的订单</a></li>
                    <li><a href="">意外保</a></li>
                    <li><a href="">团购订单</a></li>
                    <li><a href="">评价晒单</a></li>
                </ul>
            </div>
            <div class="ddzx">个人中心</div>
            <div class="subddzx">
                <ul>
                    <li><a href="/shangcheng/hotai/personal" style="color:#ff6700;font-weight:bold;">我的个人中心</a></li>
                    <li><a href="">消息通知</a></li>
                    <li><a href="">优惠券</a></li>
                    <li><a href="/shangcheng/hotai/shaddress" style="color:#ff6700;font-weight:bold;">收货地址</a></li>
                </ul>
            </div>
        </div>
        <div class="rtcont fr">
            <div class="grzlbt ml40">我的收获地址</div>

            <div class="shouhuo" id="s"><p>收货地址</p></div>

            <div id="ds"><p class="dizhi">新增收货地址</p></div>





                <div class="dizhis">
                        <form>
                            <span>*区域:</span>

                                <select   class="select"  name="province" id="province" onchange="loadRegion('province',2,'city');">
                                    <option value="">请选择省</option>
                                    {volist name="province" id="vo"}
                                        <option value="{$vo.id}">{$vo.cityname}</option>
                                    {/volist}

                                </select>


                            <select class="select" name="city" id="city" onclick="a()" onchange="loadRegion('city',3,'town');">
                                <option value="0" id="sx">市/县</option>
                            </select>

                            <select class="select" name="town" id="town">
                                <option value="0">镇/区</option>
                            </select>

                            </br>
                            <span>*收货人详细地址:</span><input type="text" id="xxdizhi" class="sr" placeholder="请输入你的详细地址"/>
                            </br>
                            <span>*收货人姓名:</span><input type="text" id="names" class="sr"  placeholder="请输入你的名称"/>
                            </br>
                            <span>*收货人联系电话:</span><input type="text" id="phone" class="sr"  placeholder="请输入联系电话" />
                            </br>
                            <span>*是否默认地址:</span><input type="radio" id="yes" value="1" class="sd"/>是 <input  id="no" type="radio" value="0" class="sd"/>否
                            </br>
                            <input id="commits" type="button" value="保存地址"/>

                        </form>

                </div>

                <div id="shouhuodizhi" class="d">

                    <table border="1px" cellspacing="0" cellpadding="0" width=700px>

                        <tr>

                            <th>收货人</th>
                            <th>所在地区</th>
                            <th>详细地址</th>
                            <th>电话/手机</th>
                            <th>操作</th>
                            <th></th>
                        </tr>
                        {foreach name="dizhis" item="vo"}
                        <tr>

                            <td>{$vo.name}</td>

                            <td>{$vo.quyu}</td>

                            <td>{$vo.xxdizhi}</td>
                            <td>{$vo.phone}</td>
                            <td><a href="shangcheng/hotai/deletedizhi?id={$vo.id}">删除</a>&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;<a href="shangcheng/hotai/edit?id={$vo.id}">修改</a></td>

                            {if $vo.tinyint == 0}

                                <td><a href="#" class="shewei">设为默认</a></td>

                            {else/}

                                <td class="moren"><a href="#">默认地址</a></td>
                            {/if}

                        </tr>
                        {/foreach}

                    </table>

                </div>

        </div>
        <div class="clear"></div>
    </div>
</div>
<!--引入js部分 -->
<script src="__JS__/jquery.min.js?v=2.1.4"></script>
<script src="__JS__/plugins/layer/layer.min.js"></script>
<script src="__JS__/bootstrap.min.js?v=3.3.6"></script>

<script>

    //隐藏显示添加地址或者查看地址
    $('#s').click(function (){

        $("#shouhuodizhi").show();
        $(".dizhis").hide();

    })

    //隐藏显示查看地址或者添加地址
    $('#ds').click(function (){


        $("#shouhuodizhi").hide();
        $(".dizhis").show();

    })

    function loadRegion(sel, type_id, selName) {
            $("#" + selName + " option").each(function() {
                $(this).remove();
            });
            $("<option value=0>请选择</option>").appendTo($("#" + selName));
            if($("#" + sel).val() == 0) {
                return;
            }
            $.ajax({
                url: "{:url('shangcheng/hotai/getRegion')}",
                type: 'GET',
                data: {
                    pid: $("#" + sel).val(),
                    type: type_id
                },
                dataType: "json",
                success: function(data) {
                    if(data) {
                        $.each(data, function(idx, item) {
                            $("<option value=" + item.id + ">" + item.cityname + "</option>").appendTo($("#" + selName));
                        });//city
                    } else {
                        $("<option value='0'>请选择</option>").appendTo($("#" + selName));
                    }
                }
            });
        }
        //添加地址到后台
        $("#commits").click(function (){

            //获取值三级联动的值
            var sheng =$("#province option:selected").text(); //获取省
            var city = $("#city option:selected").text(); //获取市县
            var town = $("#town option:selected").text();  //获取镇区

            //获取其他的值
            var dizhi = $("#xxdizhi").val(); //获取详细地址
            var names = $("#names").val(); //获取联系名称
            var phone = $("#phone").val(); //获取电话
            var danxuanzhi= $("input[type='radio']:checked").val(); //获取是否是默认地址的值

            //判断地址不能为空
            if(sheng == "" || city=="" || town == ""){

                layer.msg("请输入区域地址!");
                return;

            }

            if(dizhi == ""){

                layer.msg("请输入收货人详细地址!");
                return;
            }

            if(names == ""){

                layer.msg("请输入收货人姓名!");
                return;
            }
            if(phone == ""){

                layer.msg("请输入收货人电话!");
                return;
            }
            if(danxuanzhi == ""){

                layer.msg("请输入是否是默认地址!");
                return;
            }


            $.ajax({

                url: "{:url('shangcheng/hotai/addizhis')}",
                type: 'POST',
                data: {
                    sheng:sheng,
                    city:city,
                    town:town,
                    dizhi:dizhi,
                    names:names,
                    phone:phone,
                    danxuanzhi:danxuanzhi


                },
                dataType: "json",
                success: function(data) {


                    if(data.code == 1){

                        layer.msg(data.msg);
                        window.location.reload();//刷新当前页面.
                    }else{

                        layer.msg(data.msg);
                    }



                }



            })


        })
        //取消单选框选择
        $("input[type='radio']").on('click', function() {
            if ($(this).data('ischecked') == true) {
                $(this).prop('checked', false);
                $(this).data('ischecked', false);
            } else {
                $(this).prop('checked', true);
                $(this).data('ischecked', true);
            }
            $(this).parents('.z-label').siblings('.z-label').find("input[type='radio']").data('ischecked', false);
        });

</script>


<footer class="mt20 center">
    <div class="mt20">小米商城|MIUI|米聊|多看书城|小米路由器|视频电话|小米天猫店|小米淘宝直营店|小米网盟|小米移动|隐私政策|Select Region</div>
    <div>©mi.com 京ICP证110507号 京ICP备10046444号 京公网安备11010802020134号 京网文[2014]0059-0009号</div>
    <div>违法和不良信息举报电话：185-0130-1238，本网站所列数据，除特殊说明，所有数据均出自我司实验室测试</div>
</footer>
</body>
</html>